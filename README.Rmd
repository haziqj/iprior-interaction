---
title: "I-priors and interactions"
output: 
  github_document:
    # math_method: mathjax
    html_preview: true
    keep_html: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::read_chunk("02-sims.R")
library(tidyverse)
library(iprior)
library(kableExtra)
library(ggradar)
theme_set(theme_classic())
knitr::read_chunk("01-cow.R")
```

This contains the R code for our paper.

> Wicher Bergsma, Haziq Jamil (2022). *Additive interaction modelling using I-priors*.

The key documents are

1.  `02-sims.R` and `03-sims_analysis.R` contains the code for the simulations in Section 5.
2.  `01-cow.R` contains the code for the functional response model in Section 6.

In this README, the main summary of findings are presented.

## Simulations

Data pairs \$(y_i,x_i)\$, where \$x_i\\in\\mathbb R^3\$ for \$i=1,\\dots,n\$, were simulated according to the following model

\$$
y_i = \\beta_1 x_{i1} + \\beta_2 x_{i2} + \\beta_3 x_{i3} + \\beta_4 x_{i1}x_{i2} + \\beta_5 x_{i1}x_{i3} + \\beta_6 x_{i2}x_{i3} + \\beta_7 x_{i1}x_{i2}x_{i3} + \\epsilon_i
\$$

where \$\\epsilon_i\\sim N(0,\\sigma^2)\$ such that \$\\text{Corr}(\\epsilon_i,\\epsilon_j)=\\rho\$, for \$i\\neq j\$. The simulation settings were \$n=100\$, \$\\sigma=3\$, \$\\rho\\in\\{0,0.5\\}\$, and the simulations were repeated for a total of \$B=10,000\$ times.

The coefficients for the simulations were as follows.

```{r read_model_code}
```

```{r}
kbl(beta_vals, format = "pipe", row.names = TRUE)
```

The results below show proportion of times that each method selected the true model. Higher is better.

### Uncorrelated errors

```{r}
knitr::read_chunk("03-sims_analysis.R")
```

```{r, message = FALSE}
<<simres_fn>>
<<simres2>>
res_tab2 %>%
  kbl(format = "pipe", row.names = TRUE, digits = 2)
```

### Correlated errors


```{r, message = FALSE}
<<simres1>>
res_tab1 %>%
  kbl(format = "pipe", row.names = TRUE, digits = 2)
```

## Functional response model

```{r}
<<load_cow_data>>
<<plot_cow_data>>
```












